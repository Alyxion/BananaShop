<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BananaStore Window</title>
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <main class="stage">
      <section class="window-shell" id="windowShell" aria-label="Image generation window">
        <header class="window-titlebar" id="dragHandle">
          <svg class="titlebar-banana" viewBox="0 0 32 32" aria-hidden="true">
            <defs>
              <linearGradient id="tbBananaGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#ffe566"/>
                <stop offset="50%" stop-color="#ffc107"/>
                <stop offset="100%" stop-color="#e6a000"/>
              </linearGradient>
              <linearGradient id="tbPeelGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" stop-color="#fff176"/>
                <stop offset="100%" stop-color="#fdd835"/>
              </linearGradient>
              <filter id="tbGlow" x="-30%" y="-30%" width="160%" height="160%">
                <feGaussianBlur stdDeviation="1.2" result="blur"/>
                <feComposite in="SourceGraphic" in2="blur" operator="over"/>
              </filter>
            </defs>
            <g filter="url(#tbGlow)">
              <path d="M20 5c-1.5 4.5-4.5 10-10 14-2.5 1.8-5 2.8-7.2 3 1.5 2 4.2 3.2 7.2 3.2 5.5 0 11-3 14.5-8s4.5-10.5 3-15l-7.5 2.8z" fill="url(#tbBananaGrad)" stroke="#d4a017" stroke-width="0.6"/>
              <path d="M21.5 3c.4-1 0-2-.8-2.2-.6 0-1.2.6-1.5 1.6l1 2 1.3-1.4z" fill="url(#tbPeelGrad)" stroke="#c9a800" stroke-width="0.4"/>
              <path d="M17 9c-1 3-3.5 7-7 10" fill="none" stroke="rgba(255,255,255,0.55)" stroke-width="1" stroke-linecap="round"/>
            </g>
          </svg>
          <h1>Banana Store</h1>
        </header>

        <div class="window-body">
          <nav class="mobile-tabs" id="mobileTabs">
            <button type="button" class="mobile-tab active" data-tab="create">Create</button>
            <button type="button" class="mobile-tab" data-tab="result">Result</button>
          </nav>
          <div class="layout-grid" data-active-tab="create">
            <form id="generatorForm" class="panel controls">
              <h2>Create</h2>

              <label>
                Provider
                <select id="provider" name="provider"></select>
              </label>

              <label>
                Description
                <div class="description-wrap">
                  <textarea id="description" name="description" rows="4" placeholder="Describe what to generate"></textarea>
                  <div class="voice-btn-stack">
                    <button type="button" id="voiceButton" class="input-icon-btn" title="Talk me through your image idea">
                      <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M8 1a2.5 2.5 0 0 0-2.5 2.5v4a2.5 2.5 0 0 0 5 0v-4A2.5 2.5 0 0 0 8 1z" fill="currentColor"/><path d="M3.5 6.5v1a4.5 4.5 0 0 0 9 0v-1" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/><path d="M8 12.5V15" stroke="currentColor" stroke-width="1.3" stroke-linecap="round"/></svg>
                    </button>
                  </div>
                </div>
              </label>

              <div class="row">
                <label>
                  Size
                  <select id="size" name="size"></select>
                </label>
                <label>
                  Quality
                  <select id="quality" name="quality"></select>
                </label>
                <label>
                  Ratio
                  <select id="ratio" name="ratio"></select>
                </label>
              </div>

              <label class="file-input">
                Reference images (optional, multiple)
                <div class="file-input-row">
                  <input id="referenceImages" type="file" accept="image/*" multiple />
                  <button type="button" id="cameraButton" class="camera-btn" title="Take photo with camera">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M2 4.5h1.5L5 3h6l1.5 1.5H14a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-7a1 1 0 0 1 1-1z" stroke="currentColor" stroke-width="1.2" stroke-linejoin="round"/><circle cx="8" cy="8.5" r="2.5" stroke="currentColor" stroke-width="1.2"/></svg>
                    Camera
                  </button>
                  <input id="cameraInput" type="file" accept="image/*" capture="environment" hidden />
                </div>
              </label>

              <div class="primary-actions">
                <button type="submit" id="generateButton">Generate image</button>
                <button type="button" id="aiNarrationToggle" class="secondary speaker-toggle" aria-pressed="true" title="AI voice on">
                  <svg width="15" height="15" viewBox="0 0 16 16" fill="none" aria-hidden="true"><path d="M7 3.2 4.9 5H2.8A.8.8 0 0 0 2 5.8v4.4c0 .44.36.8.8.8h2.1L7 12.8c.52.45 1.3.08 1.3-.62V3.82c0-.7-.78-1.07-1.3-.62Z" fill="currentColor"/><path d="M10.6 5.2a4 4 0 0 1 0 5.6M12.2 3.6a6.3 6.3 0 0 1 0 8.8" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/></svg>
                </button>
              </div>
              <p id="status" class="status">Ready.</p>
            </form>

            <section class="panel output">
              <h2>Generated</h2>
              <div class="preview" id="previewWrap">
                <div class="progress-overlay" id="progressOverlay" hidden>
                  <svg class="banana-loader" viewBox="0 0 200 200" aria-hidden="true">
                    <defs>
                      <radialGradient id="glowGrad" cx="50%" cy="50%" r="50%">
                        <stop offset="0%" stop-color="#ffe082" stop-opacity="0.6"/>
                        <stop offset="100%" stop-color="#ffe082" stop-opacity="0"/>
                      </radialGradient>
                      <linearGradient id="bananaGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#ffe566"/>
                        <stop offset="50%" stop-color="#ffc107"/>
                        <stop offset="100%" stop-color="#e6a000"/>
                      </linearGradient>
                      <linearGradient id="peelGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                        <stop offset="0%" stop-color="#fff176"/>
                        <stop offset="100%" stop-color="#fdd835"/>
                      </linearGradient>
                      <filter id="bananaGlow" x="-40%" y="-40%" width="180%" height="180%">
                        <feGaussianBlur stdDeviation="6" result="blur"/>
                        <feComposite in="SourceGraphic" in2="blur" operator="over"/>
                      </filter>
                    </defs>
                    <circle class="loader-pulse" cx="100" cy="100" r="70" fill="url(#glowGrad)"/>
                    <circle class="loader-orbit" cx="100" cy="100" r="60" fill="none" stroke="rgba(255,193,7,0.15)" stroke-width="2" stroke-dasharray="8 12"/>
                    <circle class="loader-ring" cx="100" cy="100" r="60" fill="none" stroke="rgba(255,224,130,0.35)" stroke-width="4" stroke-linecap="round" stroke-dasharray="80 200"/>
                    <circle class="loader-ring-inner" cx="100" cy="100" r="48" fill="none" stroke="rgba(255,183,77,0.2)" stroke-width="3" stroke-linecap="round" stroke-dasharray="50 160"/>
                    <g class="loader-banana-group" filter="url(#bananaGlow)">
                      <path class="loader-banana-body" d="M118 62c-4 12-12 28-28 38-14 9-30 12-42 10 4 6 12 10 22 10 16 0 32-8 42-22s14-30 10-44l-4 8z" fill="url(#bananaGrad)" stroke="#d4a017" stroke-width="1.2"/>
                      <path class="loader-banana-peel" d="M122 54c1-3 0-6-2-7-2 0-4 2-5 5l3 6 4-4z" fill="url(#peelGrad)" stroke="#c9a800" stroke-width="0.8"/>
                      <path class="loader-banana-highlight" d="M110 72c-3 8-9 18-18 26" fill="none" stroke="rgba(255,255,255,0.5)" stroke-width="2" stroke-linecap="round"/>
                    </g>
                    <circle class="loader-sparkle s1" cx="140" cy="55" r="2.5" fill="#fff9c4"/>
                    <circle class="loader-sparkle s2" cx="60" cy="120" r="2" fill="#ffe082"/>
                    <circle class="loader-sparkle s3" cx="150" cy="130" r="1.8" fill="#fff176"/>
                    <circle class="loader-sparkle s4" cx="55" cy="70" r="2.2" fill="#ffecb3"/>
                    <circle class="loader-sparkle s5" cx="130" cy="150" r="1.5" fill="#ffd54f"/>
                    <circle class="loader-dot d1" cx="100" cy="40" r="3" fill="#ffb74d" opacity="0.8"/>
                    <circle class="loader-dot d2" cx="160" cy="100" r="3" fill="#ffb74d" opacity="0.8"/>
                    <circle class="loader-dot d3" cx="100" cy="160" r="3" fill="#ffb74d" opacity="0.8"/>
                    <circle class="loader-dot d4" cx="40" cy="100" r="3" fill="#ffb74d" opacity="0.8"/>
                  </svg>
                  <p class="loader-text">Generating image...</p>
                  <button type="button" id="cancelButton" class="cancel-btn">Cancel</button>
                </div>
                <button type="button" id="fullSizeButton" class="preview-action-btn full-size-btn" title="View 100%" hidden>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M2 2h4V0H0v6h2V2zm8-2v2h4v4h2V0h-6zM2 10H0v6h6v-2H2v-4zm12 4h-4v2h6v-6h-2v4z" fill="currentColor"/></svg>
                </button>
                <img id="previewImage" alt="Generated preview" hidden />
                <p id="emptyPreview">Your generated image will appear here.</p>
              </div>
              <div class="preview-bar" id="previewBar" hidden>
                <p id="imageHint" class="image-hint" title=""></p>
                <button type="button" id="downloadButton" class="download-btn">
                  <svg width="14" height="14" viewBox="0 0 14 14" fill="none"><path d="M7 0v9m0 0L3.5 5.5M7 9l3.5-3.5M1 12h12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  Download
                </button>
              </div>
              <div class="ai-reply-row" id="aiReplyRow" hidden>
                <p id="aiReply" class="ai-reply"></p>
                <button type="button" id="aiReplySpeakButton" class="secondary ai-reply-speak" title="Play summary">
                  <svg width="14" height="14" viewBox="0 0 16 16" fill="none" aria-hidden="true"><path d="M7 3.2 4.9 5H2.8A.8.8 0 0 0 2 5.8v4.4c0 .44.36.8.8.8h2.1L7 12.8c.52.45 1.3.08 1.3-.62V3.82c0-.7-.78-1.07-1.3-.62Z" fill="currentColor"/><path d="M10.6 5.2a4 4 0 0 1 0 5.6M12.2 3.6a6.3 6.3 0 0 1 0 8.8" stroke="currentColor" stroke-width="1.4" stroke-linecap="round"/></svg>
                </button>
              </div>

              <div class="reference-toolbar">
                <h3>References <span id="referenceMeta" class="ref-count"></span></h3>
                <div class="reference-actions">
                  <button type="button" id="clearRefsButton" class="ref-action-link" hidden>Clear all</button>
                </div>
              </div>
              <div id="referenceGallery" class="gallery" aria-live="polite"></div>
            </section>
          </div>
        </div>
      </section>
    </main>

    <section class="lightbox" id="lightbox" hidden>
      <div class="lightbox-bar">
        <p id="lightboxTitle">Image viewer</p>
        <div class="lightbox-actions">
          <button type="button" id="zoomOutButton" class="secondary">-</button>
          <button type="button" id="zoomResetButton" class="secondary">100%</button>
          <button type="button" id="zoomInButton" class="secondary">+</button>
          <button type="button" id="lightboxDownloadButton" class="secondary">
            <svg width="14" height="14" viewBox="0 0 14 14" fill="none" style="vertical-align:-2px"><path d="M7 0v9m0 0L3.5 5.5M7 9l3.5-3.5M1 12h12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
            Save
          </button>
          <button type="button" id="lightboxPrevButton" class="secondary">Prev</button>
          <button type="button" id="lightboxNextButton" class="secondary">Next</button>
          <button type="button" id="lightboxCloseButton" class="danger">Close</button>
        </div>
      </div>
      <div class="lightbox-canvas" id="lightboxCanvas">
        <img id="lightboxImage" alt="Full size preview" draggable="false" />
      </div>
    </section>

    <section class="voice-popup" id="voicePopup" hidden>
      <div class="voice-popup-card">
        <h3>Talk me through your image</h3>
        <p class="voice-popup-meta">Describe your idea naturally. We auto-send after a short silence, or you can send immediately.</p>
        <div class="voice-live-strip">
          <canvas id="voiceWaveCanvas" width="640" height="56" aria-hidden="true"></canvas>
        </div>
        <div class="voice-analytics-row">
          <canvas id="voiceBandsCanvas" width="320" height="42" aria-hidden="true"></canvas>
          <canvas id="voiceLoudnessCanvas" width="320" height="42" aria-hidden="true"></canvas>
        </div>
        <p class="voice-popup-note" id="voicePopupNote">Listening...</p>
        <div class="voice-popup-actions">
          <button type="button" id="voiceSendButton" class="secondary">Send now</button>
          <button type="button" id="voiceCancelButton" class="danger">Cancel</button>
        </div>
      </div>
    </section>

    <script src="/static/app.js" defer></script>
  </body>
</html>
